{% extends "base.html" %}

{% set current_step = 5 %}

{% block title %}R√©sultat - Votre Plan Van Life - RandoVanGo{% endblock %}

{% block hero_subtitle %}Votre plan van life{% endblock %}

{% block planning_content %}
<div class="step-section">
    <div class="step-header">
        <h2>üìã R√©capitulatif du voyage</h2>
    </div>

    <!-- Tableau r√©capitulatif -->
    <div class="plan-table">
        <table class="results-table">
            <thead>
                <tr>
                    <th>Jour</th>
                    <th>Ville</th>
                    <th>Activit√©</th>
                    <th>H√©bergement</th>
                    <th>Services</th>
                </tr>
            </thead>
            <tbody>
                <tr id="day1-row">
                    <td><strong>Jour 1</strong></td>
                    <td id="city-cell">Plougonvelin</td>
                    <td id="activity-cell">Randonn√©e s√©lectionn√©e</td>
                    <td id="accommodation-cell">Spot s√©lectionn√©</td>
                    <td id="services-cell">Services s√©lectionn√©s</td>
                </tr>
                <!-- Les autres jours seront ajout√©s ici -->
            </tbody>
        </table>
    </div>
</div>
<!-- Carte interactive -->
    <div class="map-page-container" style="margin: 2rem 0;">
        <h3 class="map-title">Visualisation sur la carte</h3>
        <div id="map" style="height: 40vh; width: 100%; border-radius: 12px; box-shadow: 0 2px 8px #0002;"></div>
    </div>
{% endblock %}

{% block navigation %}
<div class="navigation-buttons">
    <a href="{{ url_for('planificateur_etape4') }}" class="btn btn-outline">
        <i class="fas fa-arrow-left"></i>
        √âtape pr√©c√©dente
    </a>
    
    <button class="btn btn-primary btn-large" onclick="planifierJour2()">
        <i class="fas fa-plus-circle"></i>
        Planifier jour 2
    </button>
</div>
{% endblock %}

{% block scripts %}
<style>
.results-table {
    width: 100%;
    border-collapse: collapse;
    margin: 2rem 0;
    background: var(--white);
    border-radius: 12px;
    overflow: hidden;
    box-shadow: var(--shadow);
}

.results-table th,
.results-table td {
    padding: 1rem;
    text-align: left;
    border-bottom: 1px solid var(--gray-200);
}

.results-table th {
    background: var(--blue);
    color: var(--white);
    font-weight: 600;
}

.results-table tr:hover {
    background: var(--gray-50);
}

.plan-table {
    margin: 2rem 0;
}
</style>

<script>
// Remplir le tableau avec les s√©lections
document.addEventListener('DOMContentLoaded', function() {
    // R√©cup√©rer les s√©lections depuis localStorage
    const selectedHiking = localStorage.getItem('selectedHiking');
    const selectedSpot = localStorage.getItem('selectedSpot');
    const selectedServices = localStorage.getItem('selectedServices');
    
    // Remplir les cellules du tableau
    const activityCell = document.getElementById('activity-cell');
    const accommodationCell = document.getElementById('accommodation-cell');
    const servicesCell = document.getElementById('services-cell');
    
    // Activit√©
    if (selectedHiking === 'no-hiking') {
        activityCell.textContent = 'Pas de randonn√©e - D√©tente';
    } else if (selectedHiking) {
        activityCell.textContent = `Randonn√©e ${selectedHiking}`;
    } else {
        activityCell.textContent = 'Randonn√©e s√©lectionn√©e';
    }
    
    // H√©bergement
    if (selectedSpot === 'autre_hebergement') {
        accommodationCell.textContent = 'Autre h√©bergement';
    } else if (selectedSpot) {
        accommodationCell.textContent = `Spot ${selectedSpot}`;
    } else {
        accommodationCell.textContent = 'Spot s√©lectionn√©';
    }
    
    // Services
    if (selectedServices === 'aucun_service') {
        servicesCell.textContent = 'Aucun service';
    } else if (selectedServices) {
        servicesCell.textContent = selectedServices;
    } else {
        servicesCell.textContent = 'Services s√©lectionn√©s';
    }
});

function planifierJour2() {
    // Sauvegarder que le jour 1 est termin√©
    localStorage.setItem('completed_days', '1');
    
    // Rediriger vers l'√©tape 1 pour planifier le jour 2
    window.location.href = '/etape1';
}
</script>
{% endblock %}