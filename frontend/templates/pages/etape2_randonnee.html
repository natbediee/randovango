{% extends "base.html" %}

{% set current_step = 2 %}

{% block title %}√âtape 2 - Choix de la Randonn√©e - RandoVanGo{% endblock %}

{% block hero_subtitle %}S√©lectionnez votre randonn√©e pr√©f√©r√©e{% endblock %}

{% block planning_content %}
<div class="planning-step">
    <div class="step-header">
        <h2>ü•æ Jour 1 : Choisissez votre randonn√©e</h2>
        <p>S√©lectionnez l'activit√© principale qui rythmera votre premi√®re journ√©e</p>
    </div>

    <!-- Filtres rapides -->
    <div class="hiking-filters">
        <div class="filter-group">
            <label>Difficult√© :</label>
            <button class="filter-btn active" data-filter="all">Toutes</button>
            <button class="filter-btn" data-filter="facile">Facile</button>
            <button class="filter-btn" data-filter="moyen">Moyen</button>
            <button class="filter-btn" data-filter="difficile">Difficile</button>
        </div>
        <div class="filter-group">
            <label>Dur√©e :</label>
            <button class="filter-btn active" data-filter="all">Toutes</button>
            <button class="filter-btn" data-filter="court">< 2h</button>
            <button class="filter-btn" data-filter="moyen">2-4h</button>
            <button class="filter-btn" data-filter="long">> 4h</button>
        </div>
    </div>

    <!-- Liste des randonn√©es -->
    <div class="hiking-list">
        <!-- Randonn√©e 1 -->
        <div class="hiking-card" data-difficulty="facile" data-duration="moyen">
            <div class="hiking-status">
                <span class="status-badge verified">‚úÖ V√©rifi√©</span>
            </div>
            <div class="hiking-info">
                <h3>Du Minou au Mengant</h3>
                <p class="hiking-description">Magnifique sentier c√¥tier avec vue sur l'oc√©an. Phares historiques et paysages sauvages.</p>
                <div class="hiking-stats">
                    <span class="stat">
                        <i class="fas fa-clock"></i>
                        3h30
                    </span>
                    <span class="stat">
                        <i class="fas fa-route"></i>
                        8.2 km
                    </span>
                    <span class="stat">
                        <i class="fas fa-mountain"></i>
                        +120m
                    </span>
                    <span class="stat difficulty-facile">
                        <i class="fas fa-signal"></i>
                        Facile
                    </span>
                </div>
            </div>
            <div class="hiking-actions">
                <button class="btn btn-outline" onclick="showHikingMap(1)">
                    <i class="fas fa-map"></i>
                    Voir
                </button>
                <button class="btn btn-primary" onclick="selectHiking(1)">
                    Choisir
                </button>
            </div>
        </div>

        <!-- Randonn√©e 2 -->
        <div class="hiking-card" data-difficulty="moyen" data-duration="moyen">
            <div class="hiking-status">
                <span class="status-badge pending">‚ö†Ô∏è En attente</span>
            </div>
            <div class="hiking-info">
                <h3>La pointe des Renards</h3>
                <p class="hiking-description">Sentier vers une pointe sauvage offrant un panorama exceptionnel sur la mer d'Iroise.</p>
                <div class="hiking-stats">
                    <span class="stat">
                        <i class="fas fa-clock"></i>
                        2h45
                    </span>
                    <span class="stat">
                        <i class="fas fa-route"></i>
                        6.8 km
                    </span>
                    <span class="stat">
                        <i class="fas fa-mountain"></i>
                        +85m
                    </span>
                    <span class="stat difficulty-moyen">
                        <i class="fas fa-signal"></i>
                        Moyen
                    </span>
                </div>
            </div>
            <div class="hiking-actions">
                <button class="btn btn-outline" onclick="showHikingMap(2)">
                    <i class="fas fa-map"></i>
                    Voir
                </button>
                <button class="btn btn-primary" onclick="selectHiking(2)">
                    Choisir
                </button>
            </div>
        </div>

        <!-- Randonn√©e 3 -->
        <div class="hiking-card" data-difficulty="facile" data-duration="court">
            <div class="hiking-status">
                <span class="status-badge verified">‚úÖ V√©rifi√©</span>
            </div>
            <div class="hiking-info">
                <h3>Le circuit de Porsmilin</h3>
                <p class="hiking-description">Balade familiale autour de la plage de Porsmilin, id√©ale avec des enfants.</p>
                <div class="hiking-stats">
                    <span class="stat">
                        <i class="fas fa-clock"></i>
                        1h30
                    </span>
                    <span class="stat">
                        <i class="fas fa-route"></i>
                        3.2 km
                    </span>
                    <span class="stat">
                        <i class="fas fa-mountain"></i>
                        +45m
                    </span>
                    <span class="stat difficulty-facile">
                        <i class="fas fa-signal"></i>
                        Facile
                    </span>
                </div>
            </div>
            <div class="hiking-actions">
                <button class="btn btn-outline" onclick="showHikingMap(3)">
                    <i class="fas fa-map"></i>
                    Voir
                </button>
                <button class="btn btn-primary" onclick="selectHiking(3)">
                    Choisir
                </button>
            </div>
        </div>
    </div>

    <!-- Option sans randonn√©e -->
    <div class="no-hiking-option" id="noHikingCard">
        <button class="btn btn-primary no-hiking-btn" onclick="selectNoHiking()">
            Pas de rando aujourd'hui
        </button>
    </div>
</div>
{% endblock %}

{% block navigation %}
<div class="navigation-buttons">
    <a href="{{ url_for('planificateur_etape1') }}" class="btn btn-outline">
        <i class="fas fa-arrow-left"></i>
        Retour √† la ville
    </a>
    
    <a href="{{ url_for('planificateur_etape3') }}" class="btn btn-primary btn-large" id="nextStepBtn" style="display: none;">
        Valider la rando et continuer
        <i class="fas fa-arrow-right"></i>
    </a>
</div>
{% endblock %}

{% block scripts %}
<script>
// Gestion simple des filtres et s√©lection
document.addEventListener('DOMContentLoaded', function() {
    const filterBtns = document.querySelectorAll('.filter-btn');
    const hikingCards = document.querySelectorAll('.hiking-card');
    const nextStepBtn = document.getElementById('nextStepBtn');
    
    // Filtres
    filterBtns.forEach(btn => {
        btn.addEventListener('click', function() {
            // Retirer active de tous les boutons du m√™me groupe
            const group = this.parentElement;
            group.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            this.classList.add('active');
        });
    });
});

// S√©lection d'une randonn√©e
function selectHiking(id) {
    // Marquer comme s√©lectionn√©e
    document.querySelectorAll('.hiking-card').forEach(card => card.classList.remove('selected'));
    document.querySelector(`[onclick="selectHiking(${id})"]`).closest('.hiking-card').classList.add('selected');
    
    // D√©s√©lectionner la carte "pas de rando"
    document.getElementById('noHikingCard').classList.remove('selected');
    
    // M√©moriser la randonn√©e s√©lectionn√©e pour l'√©tape 3
    localStorage.setItem('selectedHiking', id);
    
    // Afficher le bouton suivant
    document.getElementById('nextStepBtn').style.display = 'block';
}

// S√©lection de "pas de randonn√©e"
function selectNoHiking() {
    // D√©s√©lectionner toutes les randonn√©es
    document.querySelectorAll('.hiking-card').forEach(card => card.classList.remove('selected'));
    
    // Marquer la carte "pas de rando" comme s√©lectionn√©e
    document.getElementById('noHikingCard').classList.add('selected');
    
    // M√©moriser le choix
    localStorage.setItem('selectedHiking', 'no-hiking');
    
    // Afficher le bouton suivant
    document.getElementById('nextStepBtn').style.display = 'block';
}

function showHikingMap(id) {
    // Ouvrir la vue cartographique avec la trace GPX de la randonn√©e
    const mapUrl = `/map/randonnee/${id}`;
    window.open(mapUrl, '_blank', 'width=1200,height=800');
}
</script>
{% endblock %}